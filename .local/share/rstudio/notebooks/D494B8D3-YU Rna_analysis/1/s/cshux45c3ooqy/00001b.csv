"0","## Calculate distance between samples"
"0","sampleDists <- dist(t(rld_counts))"
"0",""
"0","## Place distances in matrix"
"0","sampleDistMatrix <- as.matrix(sampleDists)"
"0",""
"0","## Optional, remove colnames"
"0","colnames(sampleDistMatrix) <- NULL"
"0",""
"0","## create annotation dataframe"
"0","ann <- data.frame(Condition = samples$condition)"
"0",""
"0","col <- c(""blue"", ""forestgreen"")"
"0","names(col) <- c(""tumour"", ""control"")"
"0","ann_col <- list(Condition = col)"
"0",""
"0","## match annotation rownames to distance mat"
"0","rownames(ann) <- rownames(sampleDistMatrix)"
"0",""
"0","pheatmap(mat=sampleDistMatrix,"
"0","         ## pass distance metric calculated to heatmap"
"0","         clustering_distance_rows=sampleDists,"
"0","         clustering_distance_cols=sampleDists,"
"0","         ## pass annotation dataframe "
"0","         annotation_col = ann,"
"0","         ## add colors"
"0","         annotation_colors = ann_col,"
"0","         ## heatmap colours"
"0","         col=hcl.colors(100,""GnBu"",rev=T))"
