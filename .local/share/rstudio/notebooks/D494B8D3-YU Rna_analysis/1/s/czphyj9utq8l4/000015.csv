"0","res <- as.data.frame(res1) "
"0","res$hgnc_symbol <- rownames(res)"
"0",""
"0","# compute summary stat"
"0","fgsea_rank <- res %>%"
"0","              dplyr::select(hgnc_symbol, log2FoldChange) %>%"
"0","              na.omit() %>%"
"0","              distinct() %>%"
"0","              group_by(hgnc_symbol) %>%"
"0","              summarize(stat=mean(log2FoldChange))"
"0",""
"0","fgsea_rank"
