"0","subset <- rld_counts[, 1:6]"
"0",""
"0","# now select de_up, de_down, i.e DE genes that passed the filtering our function produced"
"0","up <- rownames(de_up)"
"0","down <- rownames(de_down)"
"0",""
"0","# subset matrix to include only DE genes"
"0","key <- c(up, down)"
"0","subset <- subset[which(rownames(subset) %in% key),]"
"0",""
"0","# scale and center the values"
"0","mat <- as.matrix(scale(t(subset), center = T))"
"0",""
"0","# basic plot to check we're plotting something sensible"
"0","#pheatmap(t(mat))"
"0",""
"0","# spruce it up a bit.."
"0","ann <- data.frame(Condition = c(rep(""Tumour"", 3), rep(""Control"", 3)))"
"0","rownames(ann) <- rownames(mat)"
"0","col <- c(""blue"", ""forestgreen"")"
"0","names(col) <- c(""Tumour"", ""Control"")"
"0","ann_col <- list(Condition = col)"
"0",""
"0","pheatmap(t(mat), "
"0","         show_rownames = FALSE,"
"0","         annotation_col = ann,"
"0","         annotation_colors = ann_col,"
"0","         color = hcl.colors(100, ""PRGn"",rev=F))"
